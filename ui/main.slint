import { Slider, HorizontalBox, VerticalBox, GroupBox, ComboBox, ScrollView, LineEdit, Button, StyleMetrics } from "std-widgets.slint";
import { ThemedButton } from "themed-button.slint";
import { Search } from "search.slint";
import { SettingsBar, SettingsTab } from "side_settings_bar.slint";
import { ImageDirs } from "settings_menus/image_dirs.slint";
import { GeneralSettings } from "settings_menus/general.slint";
import { EditTags } from "settings_menus/edit_tags.slint";
import { Hotkeys } from "settings_menus/hotkeys.slint";
import { SecondaryWindow } from "test.slint";
import { Compose } from "search_menus/compose.slint";
import { FunText } from "search_menus/fun_text.slint";
import { StickerSearch } from "search_menus/sticker.slint";
import { GifSearch } from "search_menus/gif_search.slint";
import { SearchTabBar, SearchTab } from "search_tab_bar.slint";

export component SearchPopUp inherits Window {
	preferred-width: 500px;
	preferred-height: 400px;
	in-out property <string> search_style;
	in-out property <SearchTab> selected_tab;
	// no-frame: true;

	callback hello();

	VerticalBox {
		padding: 0px;
		spacing: 0px;


		HorizontalBox {
			SearchTabBar {
				selected_tab <=> selected_tab;
			}
		}

		VerticalBox {
			// padding: 0px;
			// spacing: 0px;
			width: 100%;
			height: 90%;

			Search {
				width: 100%;
				// height: 10%;
				search_style <=> search_style;
			}

			Rectangle {
				StickerSearch {
					states [
						visible when selected_tab == SearchTab.Sticker: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SearchTab.Sticker: {
							width: -1px;
							height: -1px;
						}
					]
				}

				Compose {
					states [
						visible when selected_tab == SearchTab.Compose: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SearchTab.Compose: {
							width: -1px;
							height: -1px;
						}
					]
				}

				FunText {
					states [
						visible when selected_tab == SearchTab.FunText: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SearchTab.FunText: {
							width: -1px;
							height: -1px;
						}
					]
				}

				GifSearch {
					states [
						visible when selected_tab == SearchTab.GifSearch: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SearchTab.GifSearch: {
							width: -1px;
							height: -1px;
						}
					]
				}
			}
		}
	}
}

export component MainWindow inherits Window {
	title: "Stickerbox";
	preferred-width: 800px;
	preferred-height: 600px;
	default-font-size: 18px;

	callback show-secondary-window();

	in-out property <SettingsTab> selected_tab;

	in-out property <string> location;
	in-out property <string> search_style;

	// in-out property <string> directory_from_search <=> Search.location;

	// callback click_button_cb <=> png_btn.png_button_pointer_event;

	in property <[image]> images;
	in-out property <length> images_scroll_height;

	VerticalLayout {
		padding: 0px;
		spacing: 0px;
		width: 100%;
		height: 100%;

		// Search bar
		Rectangle {
			height: 10%;

			Search {
				width: 100%;
				height: 50%;
				location <=> location;
				search_style <=> search_style;
			}
		}

		// Double Split
		HorizontalBox {
			padding: 0px;
			spacing: 0px;
			alignment: stretch;

			SettingsBar { selected_tab <=> selected_tab; }

			Rectangle {
				GeneralSettings {
					images <=> images;
					states [
						visible when selected_tab == SettingsTab.General: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SettingsTab.General: {
							width: -1px;
							height: -1px;
						}
					]
				}

				ImageDirs {
					states [
						visible when selected_tab == SettingsTab.ImgDirs: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SettingsTab.ImgDirs: {
							width: -1px;
							height: -1px;
						}
					]
				}

				EditTags {
					states [
						visible when selected_tab == SettingsTab.EditTags: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SettingsTab.EditTags: {
							width: -1px;
							height: -1px;
						}
					]
				}

				Hotkeys {
					states [
						visible when selected_tab == SettingsTab.Hotkeys: {
							width: parent.width;
							height: parent.height;
						}
						hidden when selected_tab != SettingsTab.Hotkeys: {
							width: -1px;
							height: -1px;
						}
					]
				}
			}
		}
	}
}
